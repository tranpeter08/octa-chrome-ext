{"code":"!function(e){var n={};function t(i){if(n[i])return n[i].exports;var s=n[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,t),s.l=!0,s.exports}t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&\"object\"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,\"default\",{enumerable:!0,value:e}),2&n&&\"string\"!=typeof e)for(var s in e)t.d(i,s,function(n){return e[n]}.bind(null,s));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,\"a\",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p=\"\",t(t.s=5)}({0:function(e,n){throw new Error(\"Module build failed: Error: ENOENT: no such file or directory, open '/Users/peter-mbp/projects/octa-chrome-ext/src/vue.min.js'\")},5:function(e,n,t){\"use strict\";t.r(n);const i=\"WorkBidWorkDetailHeader_Cell_Label Position_PermitsExtraDuty_Cell_Label Cell_Label\";var s={menuTitleQ:\".MainMenuCurrentItem.MainMenuClose\",queries:[{menuTitle:\"Work Bid\",bidIdClasses:\"WorkBidWorkDetailHeader_Cell_Value Position_OCTANumber_Cell_Value Cell_Value\",headerClasses:{parent:\"WorkBidWorkDetailHeader_View\",cell:\"WorkBidWorkDetailHeader_Cell Position_PermitsExtraDuty_Cell Field_Cell\",label:i,value:\"WorkBidWorkDetailHeader_Cell_Value Position_PermitsExtraDuty_Cell_Value Cell_Value\"},fieldClasses:{parent:\"RosterPositionDetailRosterAssignment\",day:\"RosterPositionDetailRosterAssignmentHeaderTitle\",detail:\"WorkBidWorkDetailRosterAssignment_View\",cell:\"WorkBidWorkDetailRosterAssignment_Cell EndTime_Cell Field_Cell\",runId:\"WorkBidWorkDetailRosterAssignment_Cell_Value Identifier_Cell_Value Cell_Value\",start:\"WorkBidWorkDetailRosterAssignment_Cell_Value StartTime_Cell_Value Cell_Value\",end:\"WorkBidWorkDetailRosterAssignment_Cell_Value EndTime_Cell_Value Cell_Value\",work:\"WorkBidWorkDetailRosterAssignment_Cell_Value WorkingTime_Cell_Value Cell_Value\",label:i,value:\"WorkBidWorkDetailRosterAssignment_Cell_Value EndTime_Cell_Value Cell_Value\"}},{menuTitle:\"Open Assignment Bid\",bidIdClasses:\"OpenAssignmentBidOpenAssignmentDetailHeader_Cell_Value OpenAssignment_OCTANumber_Cell_Value Cell_Value\",headerClasses:{parent:\"OpenAssignmentBidOpenAssignmentDetailHeader_View\",cell:\"OpenAssignmentBidOpenAssignmentDetailHeader_Cell OpenAssignment_OCTANumber_Cell Field_Cell\",label:\"OpenAssignmentBidOpenAssignmentDetailHeader_Cell_Label UnavailableWeeks_Cell_Label Cell_Label\",value:\"OpenAssignmentBidOpenAssignmentDetailHeader_Cell_Value UnavailableWeeks_Cell_Value Cell_Value\"},fieldClasses:{parent:\"OpenAssignmentDetailWorkday\",day:\"OpenAssignmentDetailWorkdayHeaderTitle\",detail:\"OpenAssignmentBidOpenAssignmentDetailWorkday_View\",cell:\"OpenAssignmentBidOpenAssignmentDetailWorkday_Cell WorkingTime_Cell Field_Cell\",runId:\"DisplayIdentifier_Cell_Value\",start:\"StartTime_Cell_Value\",end:\"EndTime_Cell_Value\",work:\"WorkingTime_Cell_Value\",label:\"OpenAssignmentBidOpenAssignmentDetailWorkday_Cell_Label Cell_Label\",value:\"OpenAssignmentBidOpenAssignmentDetailWorkday_Cell_Value Cell_Value\"}}]};var l={data:null,menu:null,settings:{menuTitle:\"\",bidIdClasses:\"\",headerClasses:{parent:\"\",cell:\"\",label:\"\",value:\"\"},fieldClasses:{parent:\"\",day:\"\",detail:\"\",cell:\"\",runId:\"\",start:\"\",end:\"\",work:\"\",label:\"\",value:\"\"}}},a={async findBid(e){return(await this.getBids())[l.settings.menuTitle].find(n=>n&&n.bidId===e)},getBids:()=>new Promise((e,n)=>{const t=l.settings.menuTitle;chrome.storage.sync.get(\"bids\",(function({bids:n}){n[t]||chrome.storage.sync.set({bids:{...n,[t]:[]}},(function(){e({...n,[t]:[]})})),e(n)}))}),async addBid(e){if(!e)return void alert(\"Please select an assignment\");const n=l.settings.menuTitle,t=await this.getBids(),i=t[n];if(!i.find(n=>n.bidId===e.bidId))return new Promise((s,l)=>{chrome.storage.sync.set({bids:{...t,[n]:[...i,e]}},(function(){s(1)}))});alert(\"Assignment already added to favorites\")},async deleteAll(){const e=await this.getBids();chrome.storage.sync.set({bids:{...e,[l.settings.menuTitle]:[]}})},async deleteById(e){const n=await this.getBids(),t=n[l.settings.menuTitle].filter(n=>n.bidId!==e);return t.length===n.length?(console.log(\"bid not found, none deleted\"),null):new Promise((e,i)=>{chrome.storage.sync.set({bids:{...n,[l.settings.menuTitle]:t}},(function(){e({...n,[l.settings.menuTitle]:t})}))})}},d={HeaderCells(e,n){const{cell:t,label:i,value:s}=l.settings.headerClasses;return`<div id=\"moonshine\"></div>\\n      <div class=\"${t} ssa-field-cell\">\\n        <div class=\"${i}\">Total Work Time: </div>\\n        <div class=\"${s}\">${e}</div>\\n      </div>\\n      <div class=\"${t} ssa-field-cell\">\\n        <div class=\"${i}\">Total Split Time: </div>\\n        <div class=\"${s}\">${n}</div>\\n      </div>\\n    `},FieldCells(e){const{cell:n,label:t,value:i}=l.settings.fieldClasses;return`<span class=\"${n} ssa-field-cell\">\\n      <span class=\"${t}\">Splits: </span>  \\n      <span class=\"${i}\">${b.parseTotal(e)}</span>\\n    </span>`},Favorites:()=>'<div id=\"ssa-app\">\\n        <fav-open \\n          :show_menu=\"showMenu\" \\n          :onclick=\"toggleMenu\">\\n        </fav-open>\\n\\n        <fav-menu\\n          :title=\"title\"\\n          :onclear=\"clearBids\" \\n          :onsave=\"saveBid\"\\n          :onclose=\"toggleMenu\"\\n          :show_menu=\"showMenu\"\\n          :bids=\"bids\"\\n        >\\n        </fav-menu>\\n      </div>'},r=t(0),o=t.n(r);o.a.component(\"fav-open\",{props:[\"onclick\",\"show_menu\"],template:'\\n      <button \\n        :class=\"[\\'ssa-button\\', {hidden: show_menu}]\" \\n        id=\"toggle-menu\" \\n        v-on:click=\"onclick\"\\n      >\\n        Favorites\\n      </button>\\n    '}),o.a.component(\"fav-bids-list\",{props:[\"bids\"],template:'<ol id=\"bids-container\">\\n    <div \\n      v-if=\"!bids || !bids.length\" class=\"no-bids\"\\n    >\\n      - No bids saved -\\n    </div>\\n   \\n    <li \\n      v-else \\n      v-for=\"(bid, i) in bids\"\\n      :key=\"bid.bidId\"\\n    >\\n      <fav-bids-list-item\\n        :bid=\"bid\"\\n        :i=\"i\"\\n      >\\n      </fav-bids-list-item>\\n    </li>\\n  </ol>'}),o.a.component(\"fav-bids-list-item\",{props:[\"bid\",\"i\"],methods:{async removeBid(){l.menu.bids=await a.deleteById(this.bid.bidId)}},template:'<li class=\"bid-item\" >\\n    <div class=\"bid-item-index\">{{i + 1}})</div>\\n    <div class=\"bid-item-detail-container\">\\n      <fav-bids-list-item-detail\\n        :label=\"\\'Bid ID\\'\"\\n        :value=\"bid.bidId\"\\n        :grid=\"\\'bid-item-grid-1\\'\"\\n      >\\n      </fav-bids-list-item-detail>\\n      <fav-bids-list-item-detail\\n        :label=\"\\'Work\\'\"\\n        :value=\"bid.totalWork\"\\n        :grid=\"\\'bid-item-grid-2\\'\"\\n      >\\n      </fav-bids-list-item-detail>\\n      <fav-bids-list-item-detail\\n        :label=\"\\'Splits\\'\"\\n        :value=\"bid.totalSplit\"\\n        :grid=\"\\'bid-item-grid-3\\'\"\\n      >\\n      </fav-bids-list-item-detail>\\n      <fav-bids-list-item-detail\\n        :label=\"\\'Days Off\\'\"\\n        :value=\"bid.daysOff.join(\\', \\')\"\\n        :grid=\"\\'bid-item-grid-4\\'\"\\n      >\\n      </fav-bids-list-item-detail>\\n\\n      <div><button v-on:click=\"removeBid\">Remove</button></div>\\n    </div>\\n  </li>'}),o.a.component(\"fav-bids-list-item-detail\",{props:[\"label\",\"value\",\"grid\"],template:\"<span :class=\\\"['bid-item-label', grid]\\\">\\n    {{label}}:{{' '}}\\n    <span class=\\\"bid-item-value\\\">{{value}}</span>\\n  </span>\"}),o.a.component(\"fav-menu\",{props:[\"onclose\",\"show_menu\",\"bids\",\"onsave\",\"onclear\",\"title\"],template:'<div id=\"SSA-menu\" :class=\"{hidden: !show_menu}\">\\n    <div class=\"menu-close-container\">\\n      <button\\n        id=\"menu-close\"\\n        class=\"ssa-button\" \\n        v-on:click=\"onclose\"\\n      >\\n        CLOSE\\n      </button>\\n    </div>\\n\\n    <h2 class=\"menu-title\">{{title}} Favorites</h2>\\n\\n    <fav-bids-list :bids=\"bids[State.settings.menuTitle]\">\\n    </fav-bids-list>\\n\\n    <div id=\"menu-button-container\">\\n      <button \\n        v-on:click=\"onclear\"\\n        class=\"ssa-button\" \\n        id=\"menu-clear\"\\n      >\\n        CLEAR\\n      </button>\\n      <button\\n        v-on:click=\"onsave\" \\n        class=\"ssa-button\" \\n        id=\"save-run\"\\n      >\\n        ADD\\n      </button>\\n    </div>\\n  </div>'});const u={renderHeaderCells(e,n,t){e.insertAdjacentHTML(\"beforeend\",d.HeaderCells(n,t))},renderFieldCells(e,n){const t=b.parseClxsStr(l.settings.fieldClasses.detail);e.querySelector(t).insertAdjacentHTML(\"beforeend\",d.FieldCells(n))},async scrape(e){const{headerClasses:n,fieldClasses:t}=l.settings,{parseClxsStr:i,parseTotal:s,getMinutes:a,getText:d,parseWorkTime:r}=b,o=document.querySelector(\"#moonshine\"),u=document.querySelector(i(n.parent));if(!u)return;const c=document.querySelectorAll(i(t.parent));if(!c.length)return void alert(\"Error :(\");let m=0,p=0,g=0,f=[];c.forEach(e=>{const n=d(e,i(t.runId));if(!n)return;if(\"OFF\"===n){const n=d(e,i(t.day));return void(n&&f.push(n))}const s=a(e,i(t.start));if(!s)return;const l=a(e,i(t.end)),u=r(d(e,i(t.work))),c=l-s,b=c-u;o||this.renderFieldCells(e,b),g+=c,m+=b,p+=u}),m=s(m),p=s(p),g=s(g),l.data={bidId:e,totalWork:p,totalSplit:m,totalTime:g,daysOff:f},o||this.renderHeaderCells(u,p,m)},renderFavorites(){document.body.insertAdjacentHTML(\"beforeend\",d.Favorites()),l.menu=new o.a({el:\"#ssa-app\",data:{data:null,showMenu:!1,bids:[],title:l.settings.menuTitle},async created(){this.bids=await a.getBids()},methods:{toggleMenu(){this.showMenu=!this.showMenu},async saveBid(){const e=document.querySelector(b.parseClxsStr(l.settings.bidIdClasses));if(!e)return void alert(\"Please select an assignment\");await u.scrape(e.innerHTML);await a.addBid(l.data)&&(this.bids=await a.getBids(),this.$nextTick((function(){const e=this.$el.querySelector(\"#bids-container\");e.scrollTo({top:e.scrollHeight,behavior:\"smooth\"})})))},async clearBids(){await a.deleteAll(this.bids),this.bids={...this.bids,[this.title]:[]}},async fetchBids(){this.bids=a.getBids()}}})}};var c=u;const m={async configureApp(){const{queries:e,menuTitleQ:n}=s;for(let t=0;t<e.length;t++){const i=e[t],s=document.querySelector(this.parseClxsStr(i.bidIdClasses)),a=document.querySelector(n),d=document.getElementById(\"ssa-app\");if(a&&a.innerHTML===i.menuTitle){l.settings=i,s&&await c.scrape(s.innerText),d||c.renderFavorites();break}}},parseClxsStr:e=>\".\"+e.split(\" \").join(\".\"),getText(e,n){const t=e.querySelector(n);return t?t.innerText:null},formatTime(e){const[n,t]=e.split(\" \"),[i,s]=n.split(\":\"),l=parseInt(i);return 60*(12===l?\"AMx\"===t?24:\"AM\"===t?0:l:\"AM\"===t?l:\"PM\"===t?l+12:l+24)+parseInt(s)},getMinutes(e,n){const t=m.getText(e,n);return t?m.formatTime(t):null},parseWorkTime(e){const[n,t]=e.split(\"h\");return 60*parseInt(n)+parseInt(t)},parseTotal:e=>`${Math.floor(e/60)}h${e%60}`,addHKeyListeners(e,n){document.addEventListener(\"keydown\",t=>{const{keyCode:i}=t;if(n.includes(i)){e[i]||(e[i]=!0);for(const t of n)if(!e[t])return;this.configureApp()}}),document.addEventListener(\"keyup\",()=>{Object.keys(e).length&&(e={})})},addChromeMsgListener(){chrome.runtime.onMessage.addListener((e,n,t)=>{\"clicked_browser_action\"===e.message&&this.configureApp()})}};var b=m;var p={init(){const e=document.getElementById(\"ApplicationBody\");new MutationObserver((function(e,n){for(let n of e){if(\"childList\"!==n.type||\"OpenAssignmentBidHome\"!==n.target.id)break;if(!n.addedNodes.length)continue;let e;for(let{id:t}of n.addedNodes)if(\"OpenAssignmentDetail\"===t){e=!0;break}if(e){b.configureApp();break}}})).observe(e,{attributes:!1,childList:!0,subtree:!0})}};window.onload=function(){console.log(\"Self-Service Assistant enabled\"),window.State=l,b.configureApp(),p.init()};b.addHKeyListeners({},[16,17,72]),b.addChromeMsgListener()}});","extractedComments":[]}